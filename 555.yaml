mixed-port: 7890
allow-lan: true
mode: Rule
log-level: info
external-controller: 127.0.0.1:9090

proxy-providers:
  SUBSCRIPTION:
    type: http
    url: "https://hMdRto.subxly.cfd:8443/api/v1/client/3bedf52c5cff9447d1b80fbfd21e94ae"
    interval: 3600
    path: ./proxy_providers/sub.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

proxy-groups:
  # åŸºç¡€ç»„
  - name: èŠ‚ç‚¹é€‰æ‹©
    type: select
    proxies:
      - æ‰‹åŠ¨åˆ‡æ¢
      - è‡ªåŠ¨é€‰æ‹©
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‡®ğŸ‡³ å°åº¦èŠ‚ç‚¹
      - ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºšèŠ‚ç‚¹
      - ğŸ‡§ğŸ‡· å·´è¥¿èŠ‚ç‚¹
      - ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹
      - ğŸ‡«ğŸ‡· æ³•å›½èŠ‚ç‚¹
      - ğŸ‡¬ğŸ‡§ è‹±å›½èŠ‚ç‚¹
      - ğŸ‡ªğŸ‡¸ è¥¿ç­ç‰™èŠ‚ç‚¹

  - name: æ‰‹åŠ¨åˆ‡æ¢
    type: select
    use:
      - SUBSCRIPTION

  - name: è‡ªåŠ¨é€‰æ‹©
    type: url-test
    use:
      - SUBSCRIPTION
    url: http://www.gstatic.com/generate_204
    interval: 300

  # æµåª’ä½“ç»„ï¼ˆæ˜¾ç¤ºå…¨éƒ¨èŠ‚ç‚¹ï¼‰
  - name: æ²¹ç®¡è§†é¢‘
    type: select
    use:
      - SUBSCRIPTION
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‡®ğŸ‡³ å°åº¦èŠ‚ç‚¹
      - ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºšèŠ‚ç‚¹
      - ğŸ‡§ğŸ‡· å·´è¥¿èŠ‚ç‚¹
      - ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹
      - ğŸ‡«ğŸ‡· æ³•å›½èŠ‚ç‚¹
      - ğŸ‡¬ğŸ‡§ è‹±å›½èŠ‚ç‚¹
      - ğŸ‡ªğŸ‡¸ è¥¿ç­ç‰™èŠ‚ç‚¹
      - æ‰‹åŠ¨åˆ‡æ¢
      - è‡ªåŠ¨é€‰æ‹©

  - name: å¥ˆé£è§†é¢‘
    type: select
    use:
      - SUBSCRIPTION
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‡®ğŸ‡³ å°åº¦èŠ‚ç‚¹
      - ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºšèŠ‚ç‚¹
      - ğŸ‡§ğŸ‡· å·´è¥¿èŠ‚ç‚¹
      - ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹
      - ğŸ‡«ğŸ‡· æ³•å›½èŠ‚ç‚¹
      - ğŸ‡¬ğŸ‡§ è‹±å›½èŠ‚ç‚¹
      - ğŸ‡ªğŸ‡¸ è¥¿ç­ç‰™èŠ‚ç‚¹
      - æ‰‹åŠ¨åˆ‡æ¢
      - è‡ªåŠ¨é€‰æ‹©

  - name: è¿ªå£«å°¼
    type: select
    use:
      - SUBSCRIPTION
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‡®ğŸ‡³ å°åº¦èŠ‚ç‚¹
      - ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºšèŠ‚ç‚¹
      - ğŸ‡§ğŸ‡· å·´è¥¿èŠ‚ç‚¹
      - ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹
      - ğŸ‡«ğŸ‡· æ³•å›½èŠ‚ç‚¹
      - ğŸ‡¬ğŸ‡§ è‹±å›½èŠ‚ç‚¹
      - ğŸ‡ªğŸ‡¸ è¥¿ç­ç‰™èŠ‚ç‚¹
      - æ‰‹åŠ¨åˆ‡æ¢
      - è‡ªåŠ¨é€‰æ‹©

  - name: Max
    type: select
    use:
      - SUBSCRIPTION
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‡®ğŸ‡³ å°åº¦èŠ‚ç‚¹
      - ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºšèŠ‚ç‚¹
      - ğŸ‡§ğŸ‡· å·´è¥¿èŠ‚ç‚¹
      - ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹
      - ğŸ‡«ğŸ‡· æ³•å›½èŠ‚ç‚¹
      - ğŸ‡¬ğŸ‡§ è‹±å›½èŠ‚ç‚¹
      - ğŸ‡ªğŸ‡¸ è¥¿ç­ç‰™èŠ‚ç‚¹
      - æ‰‹åŠ¨åˆ‡æ¢
      - è‡ªåŠ¨é€‰æ‹©

  # å…¶ä»–åŠŸèƒ½ç»„
  - name: ç”µæŠ¥æ¶ˆæ¯
    type: select
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - è‡ªåŠ¨é€‰æ‹©

  - name: OpenAi
    type: select
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - è‡ªåŠ¨é€‰æ‹©

  - name: å·´å“ˆå§†ç‰¹
    type: select
    proxies:
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - èŠ‚ç‚¹é€‰æ‹©
      - è‡ªåŠ¨é€‰æ‹©

  - name: å“”å“©å“”å“©
    type: select
    proxies:
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - å…¨çƒç›´è¿

  - name: å›½å¤–åª’ä½“
    type: select
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - è‡ªåŠ¨é€‰æ‹©

  - name: å›½å†…åª’ä½“
    type: select
    proxies:
      - å…¨çƒç›´è¿
      - èŠ‚ç‚¹é€‰æ‹©

  - name: è°·æ­ŒFCM
    type: select
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - è‡ªåŠ¨é€‰æ‹©

  - name: å¾®è½¯Bing
    type: select
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - è‡ªåŠ¨é€‰æ‹©

  - name: å¾®è½¯äº‘ç›˜
    type: select
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - è‡ªåŠ¨é€‰æ‹©

  - name: è‹¹æœæœåŠ¡
    type: select
    proxies:
      - å…¨çƒç›´è¿
      - èŠ‚ç‚¹é€‰æ‹©

  - name: æ¸¸æˆå¹³å°
    type: select
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - å…¨çƒç›´è¿

  - name: ç½‘æ˜“éŸ³ä¹
    type: select
    proxies:
      - å…¨çƒç›´è¿
      - èŠ‚ç‚¹é€‰æ‹©

  - name: å…¨çƒç›´è¿
    type: select
    proxies:
      - DIRECT

  - name: æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - èŠ‚ç‚¹é€‰æ‹©
      - å…¨çƒç›´è¿

  # åœ°åŒºåˆ†ç»„
  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "é¦™æ¸¯|HK|Hong Kong"

  - name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "å°æ¹¾|å°åŒ—|TW|Taiwan"

  - name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "æ–°åŠ å¡|ç‹®åŸ|SG|Singapore"

  - name: ğŸ‡³ğŸ‡± è·å…°èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "è·å…°|NL|Netherlands"

  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "æ—¥æœ¬|JP|Japan"

  - name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "ç¾å›½|US|United States"

  - name: ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "éŸ©å›½|KR|Korea"

  - name: ğŸ‡®ğŸ‡³ å°åº¦èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "å°åº¦|IN|India"

  - name: ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºšèŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "æ¾³å¤§åˆ©äºš|æ‚‰å°¼|AU|Australia"

  - name: ğŸ‡§ğŸ‡· å·´è¥¿èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "å·´è¥¿|BR|Brazil"

  - name: ğŸ‡©ğŸ‡ª å¾·å›½èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "å¾·å›½|DE|Germany"

  - name: ğŸ‡«ğŸ‡· æ³•å›½èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "æ³•å›½|FR|France"

  - name: ğŸ‡¬ğŸ‡§ è‹±å›½èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "è‹±å›½|UK|United Kingdom"

  - name: ğŸ‡ªğŸ‡¸ è¥¿ç­ç‰™èŠ‚ç‚¹
    type: select
    use:
      - SUBSCRIPTION
    filter: "è¥¿ç­ç‰™|ES|Spain"

# é«˜çº§åˆ†æµ
script:
  code: |
    def main(ctx, metadata):
        domain = metadata["host"] or ""

        # OpenAI
        if "openai.com" in domain or "ai.com" in domain:
            return "OpenAi"

        # YouTube
        if "youtube.com" in domain or "googlevideo.com" in domain or "ytimg.com" in domain:
            return "æ²¹ç®¡è§†é¢‘"

        # Netflix
        if "netflix.com" in domain or "nflxvideo.net" in domain or "nflxso.net" in domain:
            return "å¥ˆé£è§†é¢‘"

        # Disney+
        if "disneyplus.com" in domain or "dssott.com" in domain:
            return "è¿ªå£«å°¼"

        # Max (HBO Max)
        if "hbomax.com" in domain or "play.hbomaxcdn.com" in domain:
            return "Max"

        # Telegram
        if "t.me" in domain or "telegram.org" in domain:
            return "ç”µæŠ¥æ¶ˆæ¯"

        # å·´å“ˆå§†ç‰¹
        if "bahamut.com.tw" in domain or "gamer.com.tw" in domain:
            return "å·´å“ˆå§†ç‰¹"

        # å“”å“©å“”å“©
        if "bilibili.com" in domain or "acg.tv" in domain or "b23.tv" in domain:
            return "å“”å“©å“”å“©"

        # ç½‘æ˜“äº‘éŸ³ä¹
        if "163.com" in domain or "music.126.net" in domain:
            return "ç½‘æ˜“éŸ³ä¹"

        # è‹¹æœæœåŠ¡
        if "apple.com" in domain or "icloud.com" in domain or "me.com" in domain:
            return "è‹¹æœæœåŠ¡"

        # å¾®è½¯æœåŠ¡
        if "bing.com" in domain:
            return "å¾®è½¯Bing"
        if "onedrive.live.com" in domain or "sharepoint.com" in domain:
            return "å¾®è½¯äº‘ç›˜"

        # Google FCM
        if "googleapis.com" in domain or "gstatic.com" in domain:
            return "è°·æ­ŒFCM"

        # æ¸¸æˆå¹³å°
        if "epicgames.com" in domain or "steampowered.com" in domain or "xboxlive.com" in domain or "playstation.com" in domain:
            return "æ¸¸æˆå¹³å°"

        # ç¤¾äº¤åª’ä½“
        if "twitter.com" in domain or "facebook.com" in domain or "instagram.com" in domain or "spotify.com" in domain:
            return "å›½å¤–åª’ä½“"

        # å›½å¤–ç½‘ç«™é»˜è®¤èµ°å›½å¤–åª’ä½“
        if ctx.geoip(metadata["dst_ip"]) != "CN":
            return "å›½å¤–åª’ä½“"

        # å›½å†…ç½‘ç«™é»˜è®¤èµ°å›½å†…åª’ä½“
        if ctx.geoip(metadata["dst_ip"]) == "CN":
            return "å›½å†…åª’ä½“"

        # æœ€åå…œåº•
        return "æ¼ç½‘ä¹‹é±¼"

# å…œåº•è§„åˆ™
rules:
  - GEOIP,CN,å›½å†…åª’ä½“
  - MATCH,æ¼ç½‘ä¹‹é±¼
